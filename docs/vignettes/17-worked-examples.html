<!DOCTYPE html>
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>16 - Worked Examples ‚Ä¢ cpp4r</title><link rel="stylesheet" href="../menu.css"><link rel="stylesheet" href="../content.css"><!-- MathJax Configuration --><script>
    window.MathJax = {
      tex: {
        inlineMath: [['\\(', '\\)'], ['$', '$']],
        displayMath: [['\\[', '\\]'], ['$$', '$$']],
        processEscapes: true,
        processEnvironments: true,
        packages: {'[+]': ['ams', 'newcommand', 'configmacros']}
      },
      svg: {
        fontCache: 'global',
        scale: 1.5,  /* Scale SVG math to 150% */
        minScale: 0.5,
        mtextInheritFont: false,
        merrorInheritFont: true,
        mathmlSpacing: false,
        exFactor: 0.5  /* Adjust baseline for better alignment */
      },
      options: {
        ignoreHtmlClass: 'tex2jax_ignore',
        processHtmlClass: 'tex2jax_process'
      }
    };
  </script><script id="MathJax-script" async src="../js/tex-svg.js"></script></head><body>
<div class="main-container">
<div id="menu">
  <div>
    <img src="../man/figures/logo.svg" align="center" height="139" alt="cpp4r logo"></div>

  <div class="search-container">
    <input type="text" id="search-box" placeholder="Search..."><button id="theme-toggle" title="Toggle dark mode" aria-label="Toggle dark mode">üí°</button>
  </div>

  <div class="submenu">
    <label style="border-bottom: 0;"><a style="padding-left: 0;" href="../index.html">Home üè†</a></label>
  </div>

  <div class="submenu">
    <label>Functions</label>
    <a href="../reference/register.html">register</a>
    <a href="../reference/pkg_template.html">pkg_template</a>
    <a href="../reference/unvendor.html">unvendor</a>
    <a href="../reference/vendor.html">vendor</a>
  </div>

  <div class="submenu">
    <label>Vignettes</label>
    <a href="../vignettes/01-motivations.html">01 - Motivations for cpp4r</a>
    <a href="../vignettes/02-setup.html">02 - Setup</a>
    <a href="../vignettes/03-package-skeleton.html">03 - Package Skeleton</a>
    <a href="../vignettes/04-read-only.html">04 - Read-only versus Writable R Objects</a>
    <a href="../vignettes/05-logical-functions.html">05 - Logical Functions</a>
    <a href="../vignettes/06-rolling-functions.html">06 - Rolling Functions</a>
    <a href="../vignettes/07-statistical-functions.html">07 - Statistical Functions</a>
    <a href="../vignettes/08-logical-functions-2.html">08 - Logical Functions with Missing Values</a>
    <a href="../vignettes/09-rolling-functions-2.html">09 - Rolling Functions with Missing Values</a>
    <a href="../vignettes/10-statistical-functions-2.html">10 - Statistical Functions with Missing Values</a>
    <a href="../vignettes/11-debugging.html">11 - Debugging R Packages</a>
    <a href="../vignettes/12-external-pointers.html">12 - External Pointers</a>
    <a href="../vignettes/13-compiler-optimization.html">13 - Compiler Optimizations</a>
    <a href="../vignettes/14-linear-algebra.html">14 - Linear Algebra</a>
    <a href="../vignettes/15-internals.html">15 - Internals</a>
    <a href="../vignettes/16-FAQ.html">17 - FAQs</a>
    <a href="../vignettes/17-worked-examples.html">16 - Worked Examples</a>
  </div>

  <div class="submenu">
    <label>News</label>
    <a href="../news/index.html">Changelog</a>
  </div>
</div>
<div id="content">
<div class="content-wrapper">
<div class="content-main">
<h1>16 - Worked Examples</h1>



<div id="motivation" class="section level1">
<h1>Motivation</h1>
<p>The previous package skeleton left out some essential details, such
as testing for memory leaks and debugging. This vignette will cover
these aspects in more detail. The references for this vignette are <span class="citation">Vaughan, Hester, and Francois (2024)</span>, <span class="citation">Padgham (2022)</span>, <span class="citation">Vaughan
(2019)</span>, and <span class="citation">Wickham (2019)</span>.</p>
</div>
<div id="instructional-examples" class="section level1">
<h1>Instructional examples</h1>
<div id="solving-a-matrix-using-the-gauss-jordan-method" class="section level2">
<h2>Solving a matrix using the Gauss-Jordan method</h2>
<p>This example package covers the following topics:</p>
<ul><li>Integers</li>
<li>Doubles</li>
<li>Matrices</li>
<li>Conditionals</li>
<li>Loops (<code>for</code>)</li>
<li>Vendoring</li>
</ul><p>See the <a href="https://github.com/pachadotdev/cpp4r/tree/main/cpp4rgaussjordan">cpp4rgaussjordan</a>
package.</p>
<div id="details" class="section level3">
<h3>Details</h3>
<p>This implementation is a naive approach, but it can be used, for
example, to obtain the Ordinary Least Squares (OLS) estimator as shown
in the next section.</p>
<p>Vendoring means that the dependency code, the <code>cpp4r</code> C++
headers, are copied the project‚Äôs source tree. This ensures the
dependency code is fixed and stable until it is updated.</p>
<p>The advantage of vendoring is that changes to the <code>cpp4r</code>
package could never break the package‚Äôs code. The disadvantage is that
fixes and new features will be available after vendoring the code
again.</p>
</div>
<div id="vendoring" class="section level3">
<h3>Vendoring</h3>
<p>You can start with
<code>create_package("~/github/cpp4rgaussjordan")</code>. You can use
VSCode, but all the steps also apply to RStudio.</p>
<p>After opening <code>~/github/cpp4rgaussjordan</code>, you can run
<code>use_cpp4r()</code> to have a readily available skeleton in your
project.</p>
<p>You can run <code>use_apache_licence()</code> to have a
<code>LICENSE</code> file and indicate in <code>DESCRIPTION</code> that
your package is distributed under the Apache License.</p>
<p>Then you can run <code>cpp_vendor()</code> to copy the C++ headers
into <code>inst/include</code>.</p>
</div>
<div id="building-and-testing" class="section level3">
<h3>Building and testing</h3>
<p>You can use <code>devtools</code> to build and test the package:</p>
<pre class="r"><code># build

devtools::clean_dll()
cpp4r::cpp_register()
devtools::document()
devtools::load_all()

# test

A &lt;- matrix(c(2,1,3,-1), nrow = 2, ncol = 2)
invert_matrix(A)

&gt; invert_matrix(A)
     [,1] [,2]
[1,]  0.2  0.6
[2,]  0.2 -0.4</code></pre>
</div>
</div>
<div id="ordinary-least-squares-ols-estimator" class="section level2">
<h2>Ordinary Least Squares (OLS) estimator</h2>
<p>This example package covers the following topics:</p>
<ul><li>Integers</li>
<li>Doubles</li>
<li>Doubles matrices</li>
<li>Conditionals</li>
</ul><p>See the <a href="https://github.com/pachadotdev/cpp4r/tree/main/cpp4rols">cpp4rols</a>
package.</p>
<p>This implementation is extremely naive, quite similar to the
Gauss-Jordan example with extra steps, and it is enough to show how to
use C++ code within R.</p>
<p>One approach is to create one function per step, which means creating
one function to obtain <span class="math inline">\(X^tX\)</span>,
another for <span class="math inline">\((X^tX)^{-1}\)</span> (e.g,
implementing the Gauss-Jordan method to invert a matrix), another for
<span class="math inline">\(X^tY\)</span> and then calling each of those
functions to obtain <span class="math inline">\(\hat{\beta} =
(X^tX)^{-1}(X^tY)\)</span>.</p>
<p>A good challenge would be to implement the QR decomposition used by
the <code>lm()</code> function in R and use it to obtain the OLS
estimator in C++. <span class="citation">Drury (2016)</span> provides a
good starting point, this is not trivial to implement.</p>
<p>It is hard to beat the performance of the <code>lm()</code> function
in R, which calls compiled C and FORTRAN functions, and these functions
are fast and robust <code>lm()</code>.</p>
</div>
<div id="linear-programming-simplex-phase-2" class="section level2">
<h2>Linear programming (Simplex phase 2)</h2>
<p>This example package covers the following topics:</p>
<ul><li>Integers</li>
<li>Doubles</li>
<li>Doubles matrices</li>
<li>Conditionals</li>
<li>Loops (<code>for</code> and <code>while</code>)</li>
<li>Messages</li>
</ul><p>See the <a href="https://github.com/pachadotdev/cpp4r/tree/main/cpp4rsimplexphase2">cpp4rsimplex</a>
package.</p>
<div id="algorithm" class="section level3">
<h3>Algorithm</h3>
<p>The simplex algorithm is well described in <a href="http://athenasc.com/linoptbook.html">Introduction to Linear
Optimization</a> and there is efficient software to solve this,
including <span class="citation">Berkelaar and Csardi (2023)</span>.</p>
<p>A problem written in canonical form is represented by a table such
as:</p>
<p><span class="math display">\[
\begin{array}{ccc|c}
x_1 &amp; \cdots &amp; x_n &amp; \\
\hline
c_1 &amp; \cdots &amp; c_n &amp; -z \\
a_{11} &amp; \cdots &amp; a_{1n} &amp; b_1 \\
\vdots &amp; \ddots &amp; \vdots &amp; \vdots \\
a_{m1} &amp; \cdots &amp; a_{mn} &amp; b_m
\end{array}
\]</span></p>
<p>where <span class="math inline">\(c_1, \ldots, c_n\)</span> are the
coefficients of the objective function (i.e., costs), <span class="math inline">\(a_{11}, \ldots, a_{mn}\)</span> are the
coefficients of the constraints, and <span class="math inline">\(b_1,
\ldots, b_m\)</span> are the right-hand side of the constraints.</p>
<p>The simplex algorithm to solve the problem consists in the next
steps:</p>
<ol style="list-style-type: decimal"><li>If <span class="math inline">\(c_j \geq 0\)</span> for all <span class="math inline">\(j\)</span>, then the current solution is optimal.
Basic variables are equal to <span class="math inline">\(b_i\)</span>
and non-basic variables are equal to 0.</li>
<li>If <span class="math inline">\(c_j &lt; 0\)</span> for some <span class="math inline">\(j\)</span>, choose it to enter the base. Choose
the variable with the most negative <span class="math inline">\(c_j\)</span>, and assume that it is <span class="math inline">\(j = s\)</span>.</li>
<li>If <span class="math inline">\(a_{is} \leq 0\)</span> for all <span class="math inline">\(i\)</span>, then the problem is unbounded.</li>
<li>If <span class="math inline">\(a_{is} &gt; 0\)</span> for some <span class="math inline">\(i\)</span>, choose <span class="math inline">\(i =
r\)</span> such that <span class="math inline">\(b_r / a_{rs} = \min(b_i
/ a_{is},\: a_{is} &gt; 0)\)</span> and pivot on <span class="math inline">\(a_{rs}\)</span>, to then go back to step 1.</li>
</ol><p>The coefficients are updated according to:</p>
<ol style="list-style-type: decimal"><li><span class="math inline">\(a_{ij} \leftarrow a_{ij} - (a_{is}
a_{rj}) / a_{rs}\)</span> for <span class="math inline">\(j \neq
s\)</span></li>
<li><span class="math inline">\(a_{rj} \leftarrow a_{rj} /
a_{rs}\)</span></li>
<li><span class="math inline">\(b_i \leftarrow b_i - (a_{is} b_r) /
a_{rs}\)</span> for <span class="math inline">\(i \neq r\)</span></li>
<li><span class="math inline">\(b_r \leftarrow b_r /
a_{rs}\)</span></li>
<li><span class="math inline">\(c_j \leftarrow c_j - (c_s a_{rj}) /
a_{rs}\)</span></li>
<li><span class="math inline">\(-z \leftarrow -z - (c_s b_r) /
a_{rs}\)</span></li>
</ol><p>This algorithm is equivalent to Gauss method to solve linear
systems.</p>
</div>
<div id="numerical-example" class="section level3">
<h3>Numerical example</h3>
<p>A simple example is the following minimization problem:</p>
<p><span class="math display">\[
\begin{aligned}
\text{min} \quad &amp; -x_1 - 3x_2 \\
\text{subject to} \quad &amp; x_1 + x_2 \geq 3 \\
&amp; -3x_1 + x_2 \geq 2 \\
&amp; x_1, x_2 \geq 0
\end{aligned}
\]</span></p>
<p>In canonical form, this problem is:</p>
<p><span class="math display">\[
\begin{aligned}
\text{min} \quad &amp; -x_1 - 3x_2 + 0x_3 + 0x_4 \\
\text{subject to} \quad &amp; x_1 + x_2 + x_3 = 3 \\
&amp; -3x_1 + x_2 + x_4 = 2 \\
&amp; x_1, x_2,x_3,x_4 \geq 0
\end{aligned}
\]</span></p>
<p>The initial tableau for the problem is:</p>
<p><span class="math display">\[
\begin{array}{cccc|c}
x_1 &amp; x_2 &amp; x_3 &amp; x_4 &amp; -z \\
\hline
-1 &amp; -3 &amp; 0 &amp; 0 &amp; 0 \\
1 &amp; 1 &amp; 1 &amp; 0 &amp; 3 \\
-3 &amp; 1 &amp; 0 &amp; 1 &amp; 2
\end{array}
\]</span></p>
<p>The first row is the cost row, the last column is the right-hand
side, and the rest is the matrix <span class="math inline">\(A\)</span>.</p>
<p>The first step is to pivot on row 2 and column 2:</p>
<p><span class="math display">\[
\begin{array}{cccc|c}
x_1 &amp; x_2 &amp; x_3 &amp; x_4 &amp; -z \\
\hline
-10 &amp; 0 &amp; 0 &amp; 3 &amp; 6 \\
4 &amp; 0 &amp; 1 &amp; -1 &amp; 1 \\
-3 &amp; 1 &amp; 0 &amp; 1 &amp; 2
\end{array}
\]</span></p>
<p>The second step is to pivot on row 2 and column 1:</p>
<p><span class="math display">\[
\begin{array}{cccc|c}
x_1 &amp; x_2 &amp; x_3 &amp; x_4 &amp; -z \\
\hline
0 &amp; 0 &amp; 5/2 &amp; 1/2 &amp; 17/2 \\
1 &amp; 0 &amp; 1/4 &amp; -1/4 &amp; 1/4 \\
0 &amp; 1 &amp; 3/4 &amp; 1/4 &amp; 11/4
\end{array}
\]</span></p>
<p>Here a stopping criterion is reached: the minimum cost is
non-negative, therefore the solution is optimal and is <span class="math inline">\(x^* = (1/4, 11/4, 0 , 0)\)</span> with an optimal
value <span class="math inline">\(z^* = -17/2\)</span>.</p>
</div>
<div id="building-and-testing-1" class="section level3">
<h3>Building and testing</h3>
<p>You can use <code>devtools</code> to build and test the package:</p>
<pre class="r"><code># build

devtools::clean_dll()
cpp4r::cpp_register()
devtools::document()
devtools::load_all()

# test

c &lt;- c(-1, -3)
b &lt;- c(3, 2)

A &lt;- matrix(
    c(1, -3, 1, 1),
    nrow = 2,
    ncol = 2,
    byrow = FALSE
)

cpp4r_simplex_phase2(c, b, A)</code></pre>
<p>The result should be:</p>
<pre class="r"><code>Initial tableau:
-1 -3  0  0  0
 1  1  1  0  3
-3  1  0  1  2
Minimum cost: -3
Pivot row: 2
Pivot column: 2
====
New tableau:
-10  0  0  3  6
 4  0  1 -1  1
-3  1  0  1  2
Minimum cost: -10
Pivot row: 1
Pivot column: 1
====
New tableau:
 0  0  2.5  0.5  8.5
 1  0  0.25 -0.25  0.25
 0  1  0.75  0.25  2.75
Minimum cost: 0
Optimal solution found in 2 steps !</code></pre>
</div>
</div>
<div id="using-omp-parallelization" class="section level2">
<h2>Using OMP (parallelization)</h2>
<p>This example package covers the following topics:</p>
<ul><li>Integers</li>
<li>Doubles</li>
<li>Lists (unnamed and named)</li>
<li>Loops (<code>for</code>)</li>
<li>OpenMP parallelization</li>
</ul><p>See the <a href="https://github.com/pachadotdev/cpp4r/tree/main/cpp4romp">cpp4romp</a>
package.</p>
<div id="motivation-1" class="section level3">
<h3>Motivation</h3>
<p>One common phrase that you might find when you need to search how to
do something with <code>cpp4r</code> is: ‚Äúcpp4r does not offer OpenMP
support.‚Äù This is a myth. <code>cpp4r</code> does offer OpenMP support.
The requirements are: A processor and C++ compiler that support
OpenMP.</p>
<p>This has been tested on Windows, where you need to install <a href="https://cran.r-project.org/bin/windows/Rtools/">Rtools</a>, and
Ubuntu where you do not need anything special because the
<code>gcc</code> compiler comes with the operating system and it just
works.</p>
<p>If you are using macOS, you need to install <code>libomp</code> via
Homebrew in order to extend the <code>clang</code> compiler, and this is
explained in the <a href="https://open-box.readthedocs.io/en/latest/installation/openmp_macos.html">OpenBox
documentation</a> <span class="citation">(<span>‚ÄúEnable
<span>OpenMP</span> on <span class="nocase">macOS</span>
<span>For</span> <span>Building</span> Scikit-Learn -
<span>OpenBox</span> Documentation‚Äù</span> n.d.)</span>.</p>
</div>
<div id="enabling-openmp" class="section level3">
<h3>Enabling OpenMP</h3>
<p>You can create an R package called <code>cpp4romp</code> with the
following code:</p>
<pre class="r"><code>usethis::create_project("cpp4romp")
usethis::use_cpp4r()</code></pre>
<p>Then, you can create the file <code>R/cpp4romp-package.R</code> with
the following contents:</p>
<pre class="r"><code>## usethis namespace: start
#' @useDynLib cpp4romp, .registration = TRUE
## usethis namespace: end
NULL</code></pre>
<p>In order to get the <code>#pragma</code> instruction to work, you
need to add the following to <code>src/Makevars</code>:</p>
<pre><code>PKG_CXXFLAGS = $(SHLIB_OPENMP_CXXFLAGS) -DARMA_OPENMP_THREADS=1
PKG_LIBS = $(SHLIB_OPENMP_CXXFLAGS)
CXX_STD = CXX11</code></pre>
<p>Not adding this means that the pragma instruction will be ignored and
the functions will run in a single thread.</p>
</div>
<div id="unnamed-list" class="section level3">
<h3>Unnamed list</h3>
<p>You can add a function called <code>squared_unnamed_</code> in
<code>src/code.cpp</code> that will square each element in a vector of
doubles, so the file content corresponds to the following:</p>
<pre class="cpp"><code>#include &lt;cpp4r.hpp&gt;
#include &lt;omp.h&gt;

using namespace cpp4r;

[[cpp4r::register]] list squared_unnamed_(doubles x) {
  // create vectors y = x^2 and z = thread number
  int n = x.size();
  writable::doubles y(n);
  writable::doubles z(n);

  #pragma omp parallel for
  for (int i = 0; i &lt; n; ++i) {
    y[i] = x[i] * x[i];
    z[i] = omp_get_thread_num();
  }

  //create a list containing y and z
  writable::list out;
  out.push_back(y);
  out.push_back(z);
  return out;
}</code></pre>
<p>The previous function returns an unnamed list with two elements: the
squared vector and the thread number. The function is registered with
<code>[[cpp4r::register]]</code> so that it can be called from R.</p>
<p>C++ is strict with types, so you need to create a wrapper function
that will convert the integers to doubles to avoid accidental errors, it
will go in <code>R/cpp4romp-package.R</code>:</p>
<pre class="r"><code>#' Unnamed list with squared numbers and the threads used
#' @param x A vector of doubles
#' @export
squared_unnamed &lt;- function(x) {
  squared_unnamed_(as.double(x))
}</code></pre>
</div>
<div id="named-list" class="section level3">
<h3>Named list</h3>
<p>You can add a function called <code>squared_named_</code> in
<code>src/code.cpp</code> that does the same but returns a named list.
The additional content corresponds to the following:</p>
<pre class="cpp"><code>[[cpp4r::register]] list squared_named_(doubles x) {
  // create vectors y = x^2 and z = thread number
  int n = x.size();
  writable::doubles y(n);
  writable::doubles z(n);

  #pragma omp parallel for
  for (int i = 0; i &lt; n; ++i) {
    y[i] = x[i] * x[i];
    z[i] = omp_get_thread_num();
  }

  //create a list containing y and z
  writable::list out;
  out.push_back({"x^2"_nm = y});
  out.push_back({"thread"_nm = z});
  return out;
}</code></pre>
<p>As in the previous part, you can add a wrapper and documentation:</p>
<pre class="r"><code>#' Named list with squared numbers and the threads used
#' @param x A vector of doubles
#' @export
squared_named &lt;- function(x) {
  squared_named_(as.double(x))
}</code></pre>
</div>
<div id="building-and-testing-2" class="section level3">
<h3>Building and testing</h3>
<p>You can use <code>devtools</code> to build and test the package:</p>
<pre class="r"><code>cpp4r::cpp_register()
devtools::document()
devtools::install()</code></pre>
<p>Then, you can test the package from a new R session:</p>
<pre class="r"><code>&gt; library(cpp4romp)
&gt; squared_unnamed(1:10)
[[1]]
 [1]   1   4   9  16  25  36  49  64  81 100

[[2]]
 [1] 0 0 1 1 2 3 4 5 6 7

&gt; squared_named(1:10)
$`x^2`
 [1]   1   4   9  16  25  36  49  64  81 100

$thread
 [1] 0 0 1 1 2 3 4 5 6 7</code></pre>
</div>
</div>
<div id="implementing-a-rejection-and-bootstrap-sampler" class="section level2">
<h2>Implementing a rejection and bootstrap sampler</h2>
<p>This example package covers the following topics:</p>
<ul><li>Integers</li>
<li>Doubles</li>
<li>Matrices</li>
<li>Push back</li>
<li>Random seed state</li>
</ul><p>See the differences between cpp11, cpp4r and Rcpp:</p>
<ul><li><a href="https://github.com/pachadotdev/cpp4r/tree/main/cpp11sampling">cpp11sampling</a>
package.</li>
<li><a href="https://github.com/pachadotdev/cpp4r/tree/main/cpp4rsampling">cpp4rsampling</a>
package.</li>
<li><a href="https://github.com/pachadotdev/cpp4r/tree/main/Rcppsampling">Rcppsampling</a>
package.</li>
</ul></div>
</div>
<div id="extensive-rc-tests" class="section level1">
<h1>Extensive R/C++ tests</h1>
<p>See the <a href="https://github.com/pachadotdev/cpp4r/tree/main/cpp4rtest">cpp4rtest</a>
package. It covers over 1,000 unit tests for <code>cpp4r</code>
features, including:</p>
<ul><li>Vectors (integers, doubles, logicals, strings)</li>
<li>Matrices (integers, doubles, logicals, strings)</li>
<li>Lists (named and unnamed)</li>
<li>Data frames</li>
<li>Error handling (stop, warning, message)</li>
<li>C++ side unit tests with testthat</li>
<li>Roxygen documentation</li>
</ul></div>
<div id="useful-rc-integration-examples" class="section level1">
<h1>Useful R/C++ Integration Examples</h1>
<p>Here are some examples of C++ code integration with R using the
<code>cpp11</code> package:</p>
<ul><li><a href="https://arrow.apache.org/docs/r/">arrow</a>: An R package
that provides bindings to the Arrow C++ library. Arrow is a<br>
columnar in-memory analytics format that is extremely fast and
efficient.</li>
<li><a href="https://github.com/pachadotdev/cpp11armadillo">cpp4rarmadillo</a>:
An R package that provides bindings to the Armadillo C++ library.
Armadillo is a high-quality linear algebra library with a syntax similar
to MATLAB.</li>
<li><a href="https://github.com/pachadotdev/cpp11eigen">cpp11eigen</a>:
An R package that provides bindings to the Eigen C++ library. Eigen is a
high-performance linear algebra library with a permissive license.</li>
<li><a href="https://github.com/tidyverse/haven">haven</a>: A package
that reads and writes SPSS, Stata, and SAS files in R.</li>
<li><a href="https://github.com/pachadotdev/kendallknight">kendallknight</a>:
Implements the Kendall‚Äôs correlation coefficient in C++, achieving
speedup by using an algorithm with a complexity of <span class="math inline">\(O(n \log(n))\)</span> instead of <span class="math inline">\(O(n^2)\)</span> in base R.</li>
<li><a href="https://github.com/amices/mice">mice</a>: A package that
imputes missing data using multivariate chained equations.</li>
<li><a href="https://github.com/pachadotdev/open-redatam">redatam</a>:
C++ implementation of the Redatam file format, callable from both R and
Python.</li>
<li><a href="https://github.com/r-dbi/RPostgres">RPostgres</a>: A C++
interface to PostgreSQL using <code>cpp4r</code>.</li>
<li><a href="https://github.com/tidyverse/tidyr/">tidyr</a>: A package
that uses C++ functions to reshape data frames.</li>
</ul></div>
<div id="references" class="section level1 unnumbered">
<h1 class="unnumbered">References</h1>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-lpsolve23" class="csl-entry">
Berkelaar, Michel, and Gabor Csardi. 2023. <em>lpSolve: Interface to
‚ÄôLp_solve‚Äô v. 5.5 to Solve Linear/Integer Programs</em>. <a href="https://CRAN.R-project.org/package=lpSolve">https://CRAN.R-project.org/package=lpSolve</a>.
</div>
<div id="ref-drury16" class="csl-entry">
Drury, Matthew. 2016. <span>‚ÄúA <span>Deep</span> <span>Dive</span>
<span>Into</span> <span>How</span> <span>R</span> <span>Fits</span> a
<span>Linear</span> <span>Model</span>.‚Äù</span> <a href="http://madrury.github.io/jekyll/update/statistics/2016/07/20/lm-in-R.html">http://madrury.github.io/jekyll/update/statistics/2016/07/20/lm-in-R.html</a>.
</div>
<div id="ref-openbox24" class="csl-entry">
<span>‚ÄúEnable <span>OpenMP</span> on <span class="nocase">macOS</span>
<span>For</span> <span>Building</span> Scikit-Learn -
<span>OpenBox</span> Documentation.‚Äù</span> n.d. Accessed October 19,
2024. <a href="https://open-box.readthedocs.io/en/latest/installation/openmp_macos.html">https://open-box.readthedocs.io/en/latest/installation/openmp_macos.html</a>.
</div>
<div id="ref-padgham22" class="csl-entry">
Padgham, Mark. 2022. <span>‚ÄúDebugging in <span>R</span> with a Single
Command.‚Äù</span> <a href="https://mpadge.github.io/blog/blog012.html">https://mpadge.github.io/blog/blog012.html</a>.
</div>
<div id="ref-vaughan19" class="csl-entry">
Vaughan, Davis. 2019. <span>‚ÄúDebugging an <span>R</span>
<span>Package</span> with <span>C</span>++ ‚Äì <span>Davis</span>
<span>Vaughan</span>.‚Äù</span> <a href="https://blog.davisvaughan.com/posts/2019-04-05-debug-r-package-with-cpp/">https://blog.davisvaughan.com/posts/2019-04-05-debug-r-package-with-cpp/</a>.
</div>
<div id="ref-vaughan24" class="csl-entry">
Vaughan, Davis, Jim Hester, and Roman Francois. 2024. <span>‚ÄúGet Started
with Cpp11.‚Äù</span> <a href="https://cpp11.r-lib.org/articles/cpp11.html#intro">https://cpp11.r-lib.org/articles/cpp11.html#intro</a>.
</div>
<div id="ref-wickham19" class="csl-entry">
Wickham, Hadley. 2019. <em>Advanced <span>R</span></em>. 2nd ed. Boca
Raton, Florida. <a href="https://adv-r.hadley.nz/rcpp.html">https://adv-r.hadley.nz/rcpp.html</a>.
</div>
</div>
</div>
</div>
<footer><p>Last updated: 2025-10-12 19:46:01</p>
</footer><script>
document.addEventListener('DOMContentLoaded', function() {
  // Theme toggle functionality
  const themeToggle = document.getElementById('theme-toggle');
  const currentTheme = localStorage.getItem('theme') || 'light';

  // Apply saved theme
  document.documentElement.setAttribute('data-theme', currentTheme);

  if (themeToggle) {
    themeToggle.addEventListener('click', function() {
      const currentTheme = document.documentElement.getAttribute('data-theme');
      const newTheme = currentTheme === 'dark' ? 'light' : 'dark';

      document.documentElement.setAttribute('data-theme', newTheme);
      localStorage.setItem('theme', newTheme);
    });
  }

  // Search functionality
  const searchBox = document.getElementById('search-box');
  if (!searchBox) return;

  let searchIndex = [];

  // Load search index
  fetch('../search.json')
    .then(response => response.json())
    .then(data => {
      searchIndex = data;
    })
    .catch(error => {
      console.log('Search index not available, falling back to simple search');
    });

  searchBox.addEventListener('input', function() {
    const searchTerm = this.value.toLowerCase().trim();

    if (searchTerm === '') {
      // Show all items when search is empty
      document.querySelectorAll('#menu .submenu a').forEach(function(link) {
        link.style.display = 'block';
      });
      document.querySelectorAll('#menu .submenu').forEach(function(submenu) {
        submenu.style.display = 'block';
      });
      return;
    }

    // Content-based search using search index
    if (searchIndex.length > 0) {
      const matchingUrls = new Set();

      searchIndex.forEach(function(item) {
        const searchContent = (item.title + ' ' + item.content).toLowerCase();
        if (searchContent.includes(searchTerm)) {
          matchingUrls.add(item.url);
        }
      });

      // Show/hide links based on content matches
      document.querySelectorAll('#menu .submenu a').forEach(function(link) {
        const href = link.getAttribute('href');
        const relativePath = href.replace(/^.*\//, ''); // Get just the filename part

        let isMatch = false;
        matchingUrls.forEach(function(url) {
          if (url.includes(relativePath)) {
            isMatch = true;
          }
        });

        // Also check link text for simple matches
        if (!isMatch && link.textContent.toLowerCase().includes(searchTerm)) {
          isMatch = true;
        }

        link.style.display = isMatch ? 'block' : 'none';
      });
    } else {
      // Fallback to simple name-based search
      document.querySelectorAll('#menu .submenu a').forEach(function(link) {
        const linkText = link.textContent.toLowerCase();
        link.style.display = linkText.includes(searchTerm) ? 'block' : 'none';
      });
    }

    // Show/hide entire submenus if no visible links
    document.querySelectorAll('#menu .submenu').forEach(function(submenu) {
      const visibleLinks = submenu.querySelectorAll('a[style*="display: block"]');
      const label = submenu.querySelector('label');

      // Don't hide the Home submenu
      if (label && label.textContent.includes('Home')) {
        return;
      }

      submenu.style.display = visibleLinks.length > 0 ? 'block' : 'none';
    });
  });
});
</script></div>
</div>
</div>
</body></html>

